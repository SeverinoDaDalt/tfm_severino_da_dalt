
In~\cite{regularity_lemmas_for_stable_graphs}, the authors show that a critical
cause of the irregularity of pairs is the presence of a particular structure in the graph, called a \emph{half-graph}.
In fact, in the paper, they prove multiple versions of the regularity lemma which, in a context of graphs without (large)
half-graphs, not only improve drastically the bound on the number of parts, but also completely removes any irregular pair.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

        A couple of of notes need to be made about what is purposely not specified in the previous definition.
        First, vertices from the same sequence are clearly different, since they are uniquely described by the
        connectivity with the other set.
        On the other hand, the two sequences of vertices need not to be disjoint, allowing any pair $a_i, b_j$ with
        $\neg a_i R b_j$ to represent the same vertex.
        Also, the definition does not specify whether vertices from the same sequence are connected or not.
        This results, in the property not only excluding just half-graphs, but a much larger class of subgraphs.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \remark
        Notice that the previous two definitions become meaningful only if $|A|^{\epsilon} \leq \frac{\parstraight{A}}{2}$ and
        $f(|A|) \leq \frac{\parstraight{A}}{2}$ respectively.
        In this context, the definition of the truth value $t$ is compatible with that of Definition~\ref{def:truth_value}.
        In particular, Definition~\ref{def:epsilon_indivisible} would require that $\parstraight{A} \geq \parround{2}^{\frac{1}{1-\epsilon}}$.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \lemma[Claim 4.5]\label{existance_of_ordered_epsilon_indivisible_partitions}
    Let $G$ be a graph with the non-$k_{*}$-order property.
    Assume $n \geq m_0 > \dots > m_{k_{**}}$ is a sequence of non-zero natural numbers satisfying that for all $l \in [k_{**}]$
        $\lfloor (m_{l-1})^\epsilon \rfloor = m_l$, for $\epsilon \in (0, \frac{1}{2})$.
    If $A \subseteq G$, $|A| = n$, then we can find $\overline{A} = \left< A_i \mid i \in [i(*)] \right>$ with remainder
        $B = A \setminus \bigcup \overline{A}$ such that:
    \begin{enumerate}  % If you do any changes here, update 4.10 too...
        \item \label{itm:4.5.1} For each $j \in [j(*)]$, $A_j$ is $\epsilon$-indivisible
        \item \label{itm:4.5.2} For each $j \in [j(*)]$, $|A_j| \in \left\{ m_0, \dots, m_{k_{**}-1} \right\}$
        \item \label{itm:4.5.3} $A_i \cap A_j = \emptyset$ $\forall i \neq j$
        \item \label{itm:4.5.4} $|B| < m_0$
        \item \label{itm:4.5.5} $\overline{A}$ is $\leq$-increasing
    \end{enumerate}
        \begin{proof}
            The first four clauses are direct consequence of applying Claim~\ref{existance_of_f_indivisible_partitions}
                with $f(n) = n^\epsilon$.
            By renaming the $A_i$'s in ascending-size order, we get (\ref{itm:4.5.5}).
        \end{proof}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \remark
    In this context, if $m_{k_{**}} > k_{**}$
    \[
        n^{\epsilon^{k_{**}}} \geq m_0^{\epsilon^{k_{**}}} \geq m_1^{\epsilon^{k_{**}-1}} \geq \dots \geq m_{k_{**}} > k_{**}
    \]
    So, $n^{\epsilon^{k_{**}}} > k_{**}$.

    \lemma[Fact 5.9]\label{fact_5.9}
        Let $p,q \in \left( 0,1 \right)$.
        Let $A$ be a set of size $n$, $B \subseteq A$ a subset of size $p|A|$, and $A' \subseteq A$ a random subset
        of size $\geq q|A|$.
        Then, for $\zeta > 0$,
        $$
            P\left( \frac{\left| A' \cap B \right|}{\left| A' \right|} \in
                 \left( \frac{\left| B \right|}{\left| A \right|} -
                 \zeta, \frac{\left| B \right|}{\left| A \right|} + \zeta \right) \right)
        $$
        can be modeled by a random variable which is asymptotically normally distributed when $n \to +\infty$.

    \lemma[Fact 5.10]\label{fact_5.10}
        Let $A$ be a set of events measured with a probability $P_A$.
        Let $S$ a family of subsets of $A$, which are measurable with $P_A$.
        Let $A_r = \left\{ a_1, \dots, a_r \right\} \subseteq A$ be a random sample of size $r$.
        For each $B \in S$, we may define $v_B^{A_r}$ the relative frequency of events of $B$ in $A_r$, i.e.,
        $$
            v_B^{A_r} = \frac{P_A(A_r \cap B)}{P_A(A_r)}
        $$
        Let
        $$
            \pi ^{A_r} = \sup_{B \in S} \left| v_B^{A_r} - P_A(B) \right|
        $$
        i.e. the upperbound of error of $v_B^{A_r}$ as an approximation of $P_A(B)$.
        Also let $\Delta^s(A_r)$ be the number of subsets of $A_r$ induced by sets of $S$ ($B\in S$ induces
        $B \cap A_r \subseteq A_r$), i.e.
        $$
            \Delta^s(A_r) = \left| \left\{ B \cap A_r \mid B \in S \right\} \right|
        $$
        Finally, let
        $$
            m^S(r) = \max_{C \in {A \choose r}} \Delta^s(C)
        $$
        Then, if there exists a finite $k > 0$ such that $m^s(r) \leq r^k +1$ for all $r > 0$, we have that,
        for all $\epsilon > 0$,
        $$
            \lim_{r \to +\infty} P_A\left( \pi^{A_r} > \epsilon \right) = 0
        $$

    \begin{remark}[Fact 5.12]\label{fact_5.12}
        If there exists $k > 0$ such that $m^s(r) \leq r^k + 1$ and $r$ satisfies:
        $$
            r \geq \frac{16}{\zeta^2} \left( k \log \frac{16 k}{\zeta^2} - \log \frac{\eta}{4} \right)^{k+1}
        $$
        for some $\eta > 0$, then
        $$
            P\left( \pi^{A_r} < \zeta \right) \geq 1 - \eta
        $$
        In particular, if we suppose that all events in $A$ are equiprobable and sampled without replacement, then
        $$
            P\left( \forall B \in S, \; \frac{\left| A_r \cap B \right|}{\left| A_r \right|} \in
                 \left( \frac{\left| B \right|}{\left| A \right|} -
                 \zeta, \frac{\left| B \right|}{\left| A \right|} + \zeta \right) \right) \geq 1 - \eta
        $$
        or in other words, for all but a fraction $\eta$ of all possible choices of $A_r$, we have that
        $$
            \forall B \in S, \; \frac{\left| A_r \cap B \right|}{\left| A_r \right|} \in
                 \left( \frac{\left| B \right|}{\left| A \right|} -
                 \zeta, \frac{\left| B \right|}{\left| A \right|} + \zeta \right)
        $$
    \end{remark}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

            \item For each $b \in G$ we say that $\overline{B}_{A,b}$ is \emph{exceptional} if
                $\left| \overline{B}_{A,b} \right| \geq \epsilon \left| A' \right|$.
                Notice that, if we prove that, with probability $1-\xi$, $A'$ satisfies that for all exceptional $\overline{B}_{A,b}$:
                $$
                    \frac{\left| A' \cap \overline{B}_{A,b} \right|}{\left| A' \right|} \in
                         \left( \frac{\left| \overline{B}_{A,b} \right|}{\left| A \right|} -
                         \zeta, \frac{\left| \overline{B}_{A,b} \right|}{\left| A \right|} + \zeta \right)
                $$
                then, with the same probability:
                \begin{equation}\label{eq:equation1}
                    \left| A' \cap \overline{B}_{A,b} \right| < \left( \frac{\left| \overline{B}_{A,b} \right|}{|A|} + \zeta \right) |A'|
                        < \left( \epsilon + \zeta \right) |A'|
                \end{equation}
                and we are done.

                By Lemma~\ref{fact_5.9}, for $n = |A|$ large enough, we can approximate sampling a set of size $m$ from $A$,
                with $m$ i.i.d. random variables $x_1, \dots, x_m$, where each $x_i$ picks a vertex uniformly at random from $A$.
                Let $S \coloneq \left\{ \text{Exceptional } \overline{B}_{A,b} \right\}$.
                Since $G$ has the non-$k_{*}$-order property, we can apply Lemma~\ref{itm:2.6.1} to $G_{\ref{itm:2.6.1}} = A$
                and $A_{\ref{itm:2.6.1}} = A'$, which gets us that:
                $$
                    |S| \leq \left|\left\{ \left\{ a \in A' \mid a R b \not\equiv t(A', b) \right\} \mid b \in G \right\} \right|
                    \leq |A'|^{k_*}
                $$
                Then,
                $$
                    m^s(\ell) \leq \left| S \right| \leq |A'|^{k_*} \leq \ell^{k_*} \leq \ell^{k_{*}} + 1 \quad \forall \ell \geq |A'|
                $$
                Notice that this is enough to satisfy the conditions of Lemma~\ref{fact_5.10}:
                For each $\ell < |A'|$, let $k_l$ be the smallest integer such that $m^s(\ell) \leq \ell^{k_l} + 1$.
                Since there are finitely many of them, we can take the maximum
                $k_{\max} = \max \left\{ k_1, \dots, k_{|A'|-1}, k_* \right\}$, which satisfies
                $$
                    m^s(\ell) \leq \ell^{k_{\max}} + 1 \quad \forall \ell
                $$
                So we conclude equation (\ref{eq:equation1}), which by itself is sufficient to prove $A'$ is
                $(\epsilon + \zeta)$-good.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

            \[
                M \leq \ceil{\frac{12}{\min\parround{\frac{\sqrt{\gamma}}{2}, \frac{\epsilon_{\ref{lem:H_like_partition_implies_H_abundance}}
                    \parround{1 - \frac{\sqrt{\gamma}}{2}, \ell}}{\ell}}}}^{2^{k_*+1}-1}
            \]

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \begin{lemma}[Claim 4.14] \label{lem:existance_of_equitative_partition_with_bound_exceptional_pairs}
        Let $G$ be a finite graph with the non-$k_{*}$-order property.
        Let $\Partriangle{m_\ell \mid \ell \in \parcurly{0, \dots, k_{**}}}$ be a sequence of non-zero natural numbers such that
        for all $\ell \in \parcurly{0, \dots, k_{**}-1}$, $\floor{m_\ell^\epsilon} = m_{\ell+1}$,
        for some $\epsilon \in (0, \frac{1}{2})$ such that $2 < (m_{k_{**}-1})^{1-2\epsilon}$.
        Also, suppose $m_0$ satisfies $m_0 < \frac{n}{n^{(1 - 2\epsilon)\epsilon^{k_{**}}}}$ and
        $n^\epsilon \leq m_0 \leq \frac{\sqrt{2}-1}{\sqrt{2}} n$.
        Finally, let $m_{**}$ be a divisor of $m_\ell$ for all $\ell \in \parcurly{0, \dots, k_{**}-1}$ and
        $m_{**} \leq n^{\frac{\epsilon^{k_{**}+1}}{3}}$.
        If $A \subseteq G$ with $|A| = n$, then we can find a partition $\overline{A} = \Partriangle{A_i \mid i \in \parcurly{1, \dots, r}}$
        with reminder $B = A \setminus \bigcup \overline{A}$ such that:
        \begin{enumerate}
            \item \label{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.1} $|A_i| = m_{**}$ for all $i \in \parcurly{1, \dots, r}$.
            \item \label{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.2} For all but $\frac{2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}}r^2$ of the pairs
                $(A_i, A_j)$ with $i<j$ there are no exceptional edges, i.e.
                \[
                    \parcurly{(a,b) \in A_i \times A_j \mid a R b \not\equiv t(A_i, A_j)} = \emptyset
                \]
            \item \label{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.3} $|B| < m_0$
        \end{enumerate}
        \begin{proof}
            We can use \Cref{lem:existance_of_ordered_f_indivisible_partitions} to get a partition
            $\overline{A'} = \Partriangle{A'_i \mid i \in \parcurly{1, \dots, i(*)}}$ and remainder $B' = A \setminus \bigcup A'$.
            We can refine the partition by randomly splitting each $A'_i$ into pieces of size $m_{**}$ (\dref{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.1}).
            Consider the resulting partition $\overline{A} = \Partriangle{A_i \mid i \in \parcurly{1, \dots, r}}$ with remainder $B = B'$
            (\dref{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.3}).
            First of all, notice that for each pair $(A_i, A_j)$ such that $A_i \subseteq A'_{i_1}$ and
            $A_j \subseteq A'_{j_1}$ with $i_1 \neq j_1$, the probability of the pair having exceptional edges is
            upper bounded by $\frac{2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}}$.
            This follows \Cref{lem:bound_on_the_probability_of_a_subpair_having_no_exceptions} in the context of
            \Cref{rmk:subpair_bound_specification}.
            Thus, given $X$ the random variable counting the number of exceptional pairs of this kind, we have
            \[
                E(X) = \sum_{\substack{A_i,A_j \text{ s.t.}\\A_i\subseteq A'_{i_1},A_j\subseteq A'_{j_1}\\i_1\neq j_1}} E(X_{A_i, A_j})
                     = \sum_{\substack{A_i,A_j \text{ s.t.}\\A_i\subseteq A'_{i_1},A_j\subseteq A'_{j_1}\\i_1\neq j_1}} P(\varepsilon_{A_i, A_j,m_{**}})
                     \leq \frac{r^2}{2} \frac{2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}}
            \]
            where $X_{A_i,A_j}$ is the random variable giving $1$ if $(A_i, A_j)$ is exceptional, and $0$ otherwise.
            Since the expectation is an average, for some refinement $\overline{A}$ of $\overline{A'}$ we have that
            the number of exceptional pairs when $i_1 \neq j_1$ is at most $\frac{r^2}{2} \frac{2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}}$.
            Now, we have no control if $i_1 = j_1$, so let's bound how many of these we have:
            \[
                \begin{split}
                    |\parcurly{\text{Exceptional } (A_i, A_j) \mid A_i, A_j \subseteq A'_{i_1}, i_1 \in \parcurly{1, \dots, i(*)}}|
                        & \leq {\frac{m_0}{m_{**}} \choose 2} \frac{n}{m_0} \\
                        & \leq \frac{\parround{\frac{m_0}{m_{**}}}^2}{2} \frac{n}{m_0}
                            = \frac{m_0 n}{2 m_{**}^2}
                            = \frac{m_0}{n} \parround{\frac{n}{\sqrt{2}m_{**}}}^2 \\
                        & \leq \frac{m_0}{n} \parround{\frac{n - m_0}{m_{**}}}^2
                            \leq \frac{m_0}{n} r^2
                            < \frac{r^2}{n^{(1-2\epsilon) \epsilon^{k_{**}}}}
                \end{split}
            \]
            Notice that the third inequality comes after the condition $m_0 \leq \frac{\sqrt{2}-1}{\sqrt{2}} n$.
            Putting it all together, we see that the number of exceptional pairs is upper bounded by
                $\frac{2r^2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}}$ satisfying \dref{itm:existance_of_equitative_partition_with_bound_exceptional_pairs.2}.
        \end{proof}
    \end{lemma}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \begin{theorem}[Theorem 4.16] \label{thm:existance_of_equitative_partition_with_perfect_pairs_but_with_bound_exceptional_pairs}
        Let $\epsilon = \frac{1}{r} \in \parround{0, \frac{1}{2}}$ with $r \in \mathbb{N}$ (this avoids rounding error)
        and $k_*$ be given.
        Let $G$ be a finite graph with the non-$k_*$-order property.
        Let $A \subseteq G$ with $|A| = n$, and $n > 2^{\frac{r^{k_**}}{1-2\epsilon}}$.
        Then, for any $m_{**} \in \parsquared{n^{\frac{\epsilon^{k_{**}+2}}{3}},
        \parround{\frac{\sqrt{2}-1}{\sqrt{2}}}^{\frac{1}{3}\epsilon^{k_{**}+1}} n^{\frac{\epsilon^{k_{**}+1}}{3} -
        \frac{1-2\epsilon}{3}\epsilon^{2k_{**} + 1}}}$, there is a partition
        $\overline{A} = \Partriangle{A_i \mid i \in \parcurly{1, \dots, m}}$ of $A$ with remainder
        $B = A \setminus \bigcup \overline{A}$ such that:
        \begin{enumerate}
            \item\label{itm:existance_of_equitative_partition_with_perfect_pairs_but_with_bound_exceptional_pairs.1}
                $|A_i| = m_{**}$ for all $i \in \parcurly{1, \dots, m}$.
            \item\label{itm:existance_of_equitative_partition_with_perfect_pairs_but_with_bound_exceptional_pairs.2}
                $|B| < m_{**}^{3r^{k_{**}+1}}$.
            \item\label{itm:existance_of_equitative_partition_with_perfect_pairs_but_with_bound_exceptional_pairs.3}
                $|\parcurly{ (i,j) \mid i,j \in \parcurly{1, \dots, m}, i < j \text{ and }
                \parcurly{(a,b) \in A_i \times A_j \mid a R b} \notin
                \parcurly{A_i \times A_j, \emptyset}}|
                \leq \frac{2}{n^{(1-2\epsilon)\epsilon^{k_{**}}}} m^2$
        \end{enumerate}
        \begin{proof}
            Let $m_{k_{**}} = m_{**}^{3r}$, and consider the sequence
            \[
                m_{**} \leq m_{k_{**}} < \dots < m_0
            \]
            such that for all $\ell \in \parcurly{1, \dots, k_{**}}$ we have that $m_{\ell-1} = m_\ell^r$.
            Notice that:
            \begin{enumerate}
                \item $m_{**}$ divides $m_\ell$ for all $\ell \in \parcurly{0, \dots, k_{**}}$ since the $m_\ell$'s are powers of $m_{k_{**}}$
                    and $m_{**}$ divides $m_{k_{**}}$ by construction.
                \item $(m_{\ell-1})^\epsilon = m_\ell$ for all $\ell \in \parcurly{1, \dots, k_{**}}$.
                \item $m_{**} \leq n^{\frac{1}{3}\epsilon^{k_{**}+1}}$.
                \item $m_0 = m_{**}^{3r^{k_{**}+1}}$, so on one hand
                    \[
                        m_0 = m_{**}^{3r^{k_{**}+1}} \geq n^{\frac{1}{3}\epsilon^{k_{**}+2} 3r^{k_{**}+1}}
                            \geq n^{\epsilon}
                    \]
                    and on the other hand,
                    \[
                        m_0 = m_{**}^{3r^{k_{**}+1}} \leq \parround{\frac{\sqrt{2}-1}{\sqrt{2}}} n^{1 - \parround{1 - 2\epsilon} \epsilon^{k_{**}}}
                    \]
                    and thus $n$ is both smaller than $\parround{\frac{\sqrt{2}-1}{\sqrt{2}}} n$ and
                    smaller than $n^{1 - \parround{1 - 2\epsilon} \epsilon^{k_{**}}}$.
                \item $m_{k_{**}-1} = m_{**}^{3r^2} \geq n^{\epsilon^{k_{**}}} > 2^{\frac{1}{1-2\epsilon}}$.
            \end{enumerate}
            So, all the conditions of \Cref{lem:existance_of_equitative_partition_with_bound_exceptional_pairs} are satisfied,
            and we can use it to get a partition $\overline{A}$ with remainder $B$ satisfying the statement.
            Notice that \dref{itm:existance_of_equitative_partition_with_perfect_pairs_but_with_bound_exceptional_pairs.2}
            is satisfied by the fact that $|B| < m_0 \leq m_{**}^{3r^{k_{**}+1}}$.
        \end{proof}
    \end{theorem}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \begin{remark} \label{rmk:subpair_bound_specification}
        Since $\epsilon < \frac{1}{2}$, we can take $c = 1 - 2\epsilon$.
        In this context, $\zeta \leq \frac{\epsilon^{k_{**}+1}}{3}$.
    \end{remark}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % old bibliography.tex
    \begin{thebibliography}{99}

        \printbibliography[heading=none]

    \end{thebibliography}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \begin{theorem}[Theorem 4.23] \label{thm:equitative_partition_high_regularity_parts_grow_with_n}
        Let $G$ be a graph with the non-$k_*$-property.
        For any $c \in \mathbb{N}$, $\epsilon, \xi \in \mathbb{R}$ satisfying the hypothesis of \Cref{lem:many_values_to_equitative_partition_with_bound_exceptional_pairs}
        (with $k = k_*$ and $\zeta = \frac{1}{k_*}$), any $\theta \in (0,1)$ and $A \subseteq G$ large enough
        $\parstraight{A} = n > N\parround{c, \epsilon, \zeta, \xi, \theta}$,
        there is a partition $\overline{A} = \Partriangle{A_i \mid i \in \parcurly{1, \dots, i(*)}}$ of $A$ with remainder
        $B = A \setminus \bigcup_{i \in \parcurly{1, \dots, i(*)}} A_i$ satisfying:
        \begin{itemize}
            \item $|A_i| = \lfloor \lfloor n^\theta \rfloor ^\zeta \rfloor$ for all $i \in \parcurly{1, \dots, i(*)}$.
            \item $A_i$ is $c$-indivisible for all $i \in \parcurly{1, \dots, i(*)}$ where $c$ is the constant function $f(x) = c$.
            \item $|B| < m_0 \approx n^{\frac{\theta}{\epsilon^{k_{**}}}}$.
                to write the real bound in a clear way without error or absurdly worse bounds. I think the better
                solution is to force $\epsilon$ (and possibly other parameters) to be a fraction $\frac{1}{r}$.
                If so, make a remark saying that this condition is not necessary but makes bounds cleaner.}
        \end{itemize}
        \begin{proof}
            Let $n > N\parround{c, \epsilon, \zeta, \xi, \theta} \coloneqq \bparround{g_\epsilon^{k_{**}}\bparround{N_{\ref{lem:n_large_enough_valid_values}}
                \parround{ \epsilon, \frac{1}{k_*}, \frac{\xi}{\epsilon^{k_{**}}}, c}} + 1 }^{\frac{1}{\theta}}$,
            so that $\lfloor n^\theta \rfloor$ satisfies the large enough condition of
            \Cref{lem:many_values_to_equitative_partition_with_bound_exceptional_pairs}:
            \[
                \lfloor n^\theta \rfloor
                    > g_\epsilon^{k_{**}}\bparround{N_{\ref{lem:n_large_enough_valid_values}}
                        \parround{\epsilon, \frac{1}{k_*}, \frac{\xi}{\epsilon^{k_{**}}}, c}}
            \]
            Now, we define a decreasing sequence $m_0 > m_1 > \dots > m_{k_{**}}$ with $m_{k_{**}} = \lfloor n^\theta \rfloor$
            and $m_{\ell} = \lceil \parround{m_{\ell+1}}^{\frac{1}{\epsilon}} \rceil$ for all $\ell \in \parcurly{0, \dots, k_{**}-1}$.
            This sequence satisfies the condition of \Cref{lem:existance_of_indivisible_sets} for $f(n) = n^\epsilon$.
            We will build a sequence of disjoint $c$-indivisible subsets $A_i$ by induction on $i$ as follows.
            Let $R_i = A \setminus \bigcup_{j<i} A_j$ (so $R_1 = A$).
            If $R_i < m_0$, then
            $\overline{A} = \Partriangle{A_j \mid j < i = i(*)}$ and $B = R_i$, and we are done.
            Otherwise, we can apply \Cref{lem:existance_of_indivisible_sets} to $R_i$ with the sequence
            $\Partriangle{m_\ell}_{\ell \leq k_{**}}$, to obtain an $\epsilon$-indivisible subset $B_i \subseteq R_i$ of
            size $m_{k_{**}-\ell}$.
            Then, since $|B_i| = m_{k_{**}-\ell} \geq m_{k_{**}} = \lfloor n^\theta \rfloor$ by the $n$-large-enough assumption,
            we can apply \Cref{lem:many_values_to_equitative_partition_with_bound_exceptional_pairs} and get a
            $c$-indivisible subset $Z_i$ of size $|Z_i| = \lfloor m_{k_{**}-\ell}^\zeta \rfloor
            \geq \lfloor \lfloor n^{\frac{\theta}{\epsilon^\ell}} \rfloor ^\zeta \rfloor
            \geq \lfloor \lfloor n^{\theta} \rfloor ^\zeta \rfloor$.
            Since $c$-indivisibility is preserved when taking subsets,
            we can choose $A_i \subseteq Z_i$ to be a $c$-indivisible subset of size $\lfloor \lfloor n^{\theta} \rfloor ^\zeta \rfloor$.
        \end{proof}
    \end{theorem}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \begin{algorithm}[H]
        \caption{$\epsilon$-test $\mathcal{A}$ for deciding $H$-freeness for a given graph $H$ of size $\ell$}
        \label{alg:h-freeness_tester}
        \begin{algorithmic}[1]
            \Require a graph $G$ of size $n$ with non-$k_*$-order property
            \State $t \leftarrow \frac{2}{3}\frac{1}{\eta_{\ref{thm:property_testing_with_stable_partitions}}(k_*, \epsilon, \ell)}$
            \If{$n < \ell$}
                \State return 0 \label{line:G_smaller_then_H}
            \ElsIf{$n^\ell < t$}
                \State return 0 \label{line:G_and_H_too_small_for_t}
            \Else
                \State $S \leftarrow \emptyset$
                \While{$i \leq t$}
                    \State $S_i = \Partriangle{s_{i,1}, \dots, s_{i,\ell}}$ such that $s_{i,j} \sim G$
                    \While{$S_i \in S$}
                        \State $S_i = \parcurly{s_{i,1}, \dots, s_{i,\ell}}$ such that $s_{i,j} \sim G$
                    \EndWhile
                    \State $S \leftarrow S \cup \parcurly{S_i}$
                \EndWhile
                \State query all edges induced by the vertex set $\overline{S} = \cup_{i \leq t} S_i$
                \If{$\exists v_{i_1}, \dots, v_{i_\ell} \in \overline{S}$ such that
                        $\parcurly{v_{i_1}, \dots, v_{i_\ell}}$ induces a copy of $H$ in $G$}
                    \State return 1 \label{line:found_H}
                \Else
                    \State return 0 \label{line:not_found_H}
                \EndIf
            \EndIf
        \end{algorithmic}
    \end{algorithm}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \item \textbf{A rigorous reformulation and correction of the central proofs}
        in~\cite{regularity_lemmas_for_stable_graphs}.
        Our contribution provides a self-contained, combinatorial framework for these results, systematically
        resolving foundational gaps and inaccuracies in the original arguments to ensure their validity.
        This reworking also makes the associated combinatorial bounds fully explicit for the first time.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    In the context of graphs with no bi-induced large half-graph, a class known as \emph{stable graphs},
    the authors of~\cite{regularity_lemmas_for_stable_graphs} show that a much stronger form
    of regularity is achievable.
    Their \emph{stable regularity lemma} not only guarantees a decomposition entirely free of irregular pairs, but also yields
    vastly improved bounds on the partition size.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    Although constant with respect to the size of the input graph, the query complexity of the resulting $\epsilon$-test
    from Alon \& Shapira Theorem is very large.
    This is due to the tower function bound of Szemer\'edi's Regularity Lemma, which is unavoidable in the general
    setting~\cite{lower_bounds_of_tower_type_for_szeremedis_uniformity_lemma}.
    Another problem caused by the use of the Regularity Lemma, although less concerning, is generated by the presence of
    irregular pairs.
    Due to this, a subsequent refinement of the resulting partition may be required
    (as in \cite{regularity_lemmas_for_stable_graphs}), further increasing the complexity of the tester.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    Now, we randomly partition each part $A_i$ into $\ell$ equitable subparts $A_{i,j}$.
    By \Cref{lem:regularity_is_transitive}, each pair of such subparts is $\ell \epsilon$-regular.
    On the other hand, \Cref{thm:existance_of_regular_partitions} guarantees that such pairs have density
    at most $\epsilon$ or at least $1 - \epsilon$.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    One of the many applications of the regularity lemma for which these bounds on the number of parts become relevant is in
    \emph{property testing}.
    A property testing algorithm for a decision problem $P$ is a randomized algorithm that, by querying only a small portion
    of its input, can distinguish with high probability between objects that satisfy $P$ and those that are \say{far} from
    satisfying it.
    For instance, in~\cite{efficient_testing_of_large_graphs} the authors use Szemer\'edi's Regularity Lemma
    to prove that it is possible to test the property of a graph $G$ being $H$-free (for a fixed graph $H$) using an algorithm
    which query complexity is independent on the size of the input graph $G$.

    The query complexity of such testers, however, is intrinsically linked to the number of parts in the underlying regular
    partition.
    Consequently, the power-tower bounds of the standard regularity lemma lead to prohibitively large, although constant,
    query counts.
    This raises a natural question: can the superior bounds of the stable regularity lemma be exploited to create more
    efficient property testers for graphs in a half-graph-restricted setting?

    In this thesis, we present an algorithm for testing $H$-freeness in stable graphs, thereby providing
    a concrete application that highlights the practical strength and utility of stable regularity partitions.


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

            It is important to note what is left unspecified in \Cref{def:k_order_property}.
            First, the vertices within each sequence must be distinct, as their neighborhoods within the other sequence
            differ, which makes this definition equivalent to \say{the graph not containing a bi-induced copy of a
            $k$-half-graph}, as defined in \Cref{def:bi_induced}.
            However, the sequences themselves need not be disjoint.
            One may have $a_i=b_j$, provided $i < j$ (so that $\neg(a_i R b_j)$).
            Furthermore, the definition does not specify the presence or absence of edges within the same sequence.
            Consequently, the non-$k$-order property requires the containment of a subgraph from a broad class of structures,
            not merely a k-half-graph.

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%